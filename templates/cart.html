<!DOCTYPE HTML>
{% load static %}
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv="pragma" content="no-cache" />
<meta http-equiv="cache-control" content="max-age=604800" />
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<title>GreatKart | One of the Biggest Online Shopping Platform</title>

<link href="{% static 'images/favicon.ico' %}" rel="shortcut icon" type="image/x-icon">

<!-- jQuery -->
<script src="{% static 'js/jquery-2.0.0.min.js' %}" type="text/javascript"></script>

<!-- Bootstrap4 files-->
<script src="{% static 'js/bootstrap.bundle.min.js' %}" type="text/javascript"></script>
<link href="{% static 'css/bootstrap.css' %}" rel="stylesheet" type="text/css"/>

<!-- Font awesome 5 -->
<link href="{% static 'fonts/fontawesome/css/all.min.css' %}" type="text/css" rel="stylesheet">

<!-- custom style -->
<link href="{% static 'css/ui.css' %}" rel="stylesheet" type="text/css"/>
<link href="{% static 'css/responsive.css' %}" rel="stylesheet" media="only screen and (max-width: 1200px)" />

<!-- jQuery css for search product -->
<link rel="stylesheet" href="//code.jquery.com/ui/1.13.2/themes/base/jquery-ui.css">
<script src="https://code.jquery.com/jquery-3.6.0.js"></script>
<!-- Alertify CSS -->

<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/alertifyjs@1.13.1/build/css/alertify.min.css"/>
<!-- Default theme -->
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/alertifyjs@1.13.1/build/css/themes/default.min.css"/>

<!-- custom javascript -->
<script src="{% static 'js/script.js' %}" type="text/javascript"></script>

<script type="{% static 'text/javascript' %}">
/// some script

// jquery ready start
$(document).ready(function() {
	// jQuery code

}); 
// jquery end
</script>
<style>
	.header-main {
	  position: sticky;
	  padding-top: 1rem;
	  padding-bottom: 1rem;
	  z-index: 1000;
	}
  </style>    
<style>
	/* Red */
.danger {
	border-color: #f44336;
	color: red
  }
  
  .danger:hover {
	background: #f44336;
	color: white;
  }
  </style>

</head>
<body>
	<header class="section-header">
		<section class="header-main border-bottom">
			 <div class="container">
				 <div class="row align-items-center product_data">
					 <div class="col-lg-2 col-md-3 col-6">
						 <a href="{% url 'index' %}" class="brand-wrap">
							 <img class="logo" src="{% static 'images/logo.png' %}">
						 </a>
					 </div>
					 <div class="col-lg col-sm col-md col-6 flex-grow-0">
						 <button type="button" class="btn btn-primary dropdown-toggle" data-toggle="dropdown">
							 <i class="fa fa-bars"></i> All category
						 </button>
						 <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton1">
							 <li><a class="dropdown-item" href="{% url 'category-view' category_name='t-shirt' %}">Tshirt</a></li>
							 <li><a class="dropdown-item" href="{% url 'category-view' category_name='shirt' %}">Shirt</a></li>
							 <li><a class="dropdown-item" href="{% url 'category-view' category_name='jeans' %}">Jeans</a></li>
							 <li><a class="dropdown-item" href="{% url 'category-view' category_name='jacket' %}">Jacket</a></li>
						   </ul>
						 <!-- category-wrap -->
					 </div>
					 <!-- <a href="{% url 'store' %}" class="btn btn-outline-primary">Store</a> -->
					 <div class="col-lg col-md-6 col-sm-12 col">
						 <form action="{% url 'searchproduct' %}" class="search" method="POST">
							 {% csrf_token %}
							   <div class="input-group w-100">
								   <input type="search" required class="form-control" style="width:60%;" id="searchproduct" name="productsearch" placeholder="Search Product">
	   
								   <div class="input-group-append">
									   <button class="btn btn-primary" type="submit">
										   <i class="fa fa-search"></i>
									   </button>
								   </div>
							   </div>
						   </form> <!-- search-wrap .end// -->
					 </div>
					 <div class="col-lg-3 col-sm-6 col-8 order-2 order-lg-3">
						 <div class="d-flex justify-content-end mb-3 mb-lg-0">
							 <div class="widget-header px-4">
								 {% if request.user.is_authenticated %}
								 <button class="title text-muted py-2 mt-2" id="dropdownMenuButton2" data-bs-toggle="dropdown" aria-expanded="false" style="background-color:white; border: 1px solid #ffffff !important;">{{request.user}}</button>
									<ul class="dropdown-menu" aria-labelledby="dropdownMenuButton2">
									 <li><a class="dropdown-item" href="{% url 'index' %}">Home</a></li>
									 <li><a class="dropdown-item" href="{% url 'profile-view' %}">Profile</a></li>
									 <li><a class="dropdown-item" href="{% url 'my-orders' %}">My Orders</a></li>
									 <li><a class="dropdown-item" href="{% url 'logoutpage' %}">Logout</a></li> 
								   </ul>
								 {% else %}
								 <!-- <small class="title text-muted ">Welcome</small> -->
								 <div class = "pt-3 ">
									 <a href="./signin.html"> Login</a> <span class="dark-transp"></span>
									 <!-- <a href="./register.html"> Register</a> -->
								 </div>
								 {% endif %}
							 </div>
						   
							 <a href="{% url 'cart' %}" class="widget-header pl-3 ml-3">
								<div class="icon icon-sm rounded-circle border"><i class="fa fa-shopping-cart"></i></div>
								{% if total_quantity == 0 %}
								  <span></span>
								{% else %}
								<span class="badge badge-pill badge-danger notify">{{total_quantity}}</span>
								{% endif %}
							  </a>
							  <a href="{% url 'wishlist' %}" class="widget-header pl-3 ml-3">
								<div class="icon icon-sm rounded-circle border"><i class="fa fa-heart"></i></div>
								{% if total_item == 0 %}
								<span ></span>
								{% else %}
								<span class="badge badge-pill notify" style="background-color: green; color: white;">{{total_item}}</span>
								{% endif %}
							  </a>
						 </div>
					 </div>
				 </div>
			 </div>
		 </section>
	 </header>


<section class="section-content padding-y bg" style="width: 1519.2px; height: 661px;">
<div class="container ">

<!-- ============================ COMPONENT 1 ================================= -->
<div class="pb-2">
    <h2 style="font-weight: 300;">Shopping Cart</h2>
</div>
<div class="row">
	<aside class="col-lg-9">
<div class="card cartdata">
{% if cartitem %}
<table class="table table-borderless table-shopping-cart">
<thead class="text-muted">
<tr class="small text-uppercase ">
  <th scope="col" class="ml-4">Product</th>
  <th scope="col" width="120" class="ml-4">Quantity</th>
  <th scope="col" width="120">Unit Price</th>
  <th scope="col" class="text-right" width="200"> </th>
</tr>
</thead>
<tbody>
	{% for item in cartitem %}
<tr class="product_data">
	
	<td>
		<figure class="itemside align-items-center">
			<a href="{% url 'productdetail' item.product.id %}">
				<div class="aside"><img src="{{ item.product.image.url }}" class="img-sm"></div>
			</a>
		<figcaption class="info">
				<a href="{% url 'productdetail' item.product.id %}" class="title text-dark">{{item.product.title}}</a>
			 
			</figcaption>
		</figure>
	</td>
	<td> 
		<!-- col.// -->
				{% csrf_token %}
				<input type="hidden" value="{{ item.product.id }}" class="prod_id">
				{% if item.product.quantity >= item.product_qty %}
					<div class="col py-3"> 
						<div class="input-group input-spinner">
							<div class="input-group-prepend">
								<button class="btn btn-light ChangeQuantity button-decreament" type="button" id="button-plus">
									<i class="fa fa-minus"></i>
								</button>
							</div>
							<input type="text" class="form-control qty-input" value="{{item.product_qty}}" readonly style="background-color:white";>
							<div class="input-group-append">
								<button class="btn btn-light ChangeQuantity button-increament" type="button" id="button-minus">
									<i class="fa fa-plus"></i>
								</button>
							</div>
						</div> 
					</div> 
					{% else %}
					<label class="badge bg-danger">Out of stock</label>
					{% endif %}
	</td>
	<td> 
		<div class="price-wrap py-4"> 
			<var class="price">₹ {{ item.product.price|floatformat:"0" }}</var> 
		</div> <!-- price-wrap .// -->
	</td>
	<td class="text-right "> 
		<button type="button" class="btn btn-danger delete-cart-item  py-2 mt-2" >Remove</button>
	</td>
</tr>
{% endfor %}
{% else %}
<div class="pl-2 py-4 ml-2"  style="display: flex; justify-content: center; align-items: center; text-align: center; height:250px;">
	<h5 class="text-info">
		"You haven't placed any orders yet."
		<br>
		"We can't wait to have you as a customer."
	</h5>
</div>
<br>
<br>
<div style="display: flex; justify-content: center; align-items: center; text-align: center;">
	<strong><p>Take a look at our products here</p></strong>
</div>
<br>
<div style="justify-content: center; align-items: center; text-align: center;">
	<a href="{% url 'index' %}" class="btn text-white bg-dark my-2 mb-2">Continue Shopping</a>

</div>

{% endif %}
 </td>
	
</tr>
</tbody>
</table>
</div> <!-- card.// -->

	</aside> <!-- col.// -->
	<aside class="col-lg-3">

		<div class="card">
		<div class="card-body">
			<dl class="dlist-align">
			  <dt>Sub Total:</dt>
			  <dd class="ml-2">₹ {{sub_total|floatformat:"0" }}</dd>
			</dl>
			{% if sub_total >= 5000 %}
			<dl class="dlist-align">
				<dt>Free Delivery :</dt>
				<dd class=" ml-2">₹ 0.00</dd>
			</dl>
			{% else %}
			<dl class="dlist-align">
				<dt>Shipping:</dt>
				<dd class=" ml-2">₹ {{delivary_charge}} +</dd>
			</dl>
			{% endif %}
			<dl class="dlist-align">
				<dt>Discount :</dt>
				{% if total_quantity > 0 %}
				<dd class=" ml-2">₹ {{discount}} -</dd>
				{% else %}
				<dd class=" ml-2">₹ 0</dd>
				{% endif %}
			</dl>
			<hr>
			<dl class="dlist-align">
				<dt>Total Price :</dt>
				{% if total_quantity > 0 %}
				<dd class=" ml-2">₹ {{total_price|floatformat:"0"}}</dd>
				{% else %}
				<dd class=" ml-2">₹ 0</dd>
				{% endif %}
			</dl>
			<br>
			{% if total_quantity > 0 %}
			<button class="btn btn-block btn-primary" data-toggle="collapse" data-target="#demo">Apply Promo Code</button>
				<div id="demo" class="collapse">
					<form action="{% url 'applycoupon' %}" method="POST">
					{% csrf_token %}
					  <!-- Coupon code input field -->
                      <input type="text" class="coupon-input py-2  mt-2" required class="form-control" name="coupon_code" style="width: 240px; text-align: center;" placeholder="Enter coupon code">
					  <!-- Apply button -->
					  <button class="apply-button btn btn-block btn-success mt-2" type="submit">Apply</button>
					</form>
				</div>
			{% else %}
			<div></div>
			{% endif %}
			<br>
			<p class="text-center mb-3">
				<img src="{% static './images/misc/payments.png' %}" height="26">
			</p>
			{% if total_quantity > 0 %}
			<a href="{% url 'checkoutpage' %}" class="btn btn-primary btn-block"> Checkout </a>
			<a href="{% url 'index' %}" class="btn text-white bg-dark  btn-block"> Continue Shopping </a>
			{% else %}
			<a href="" class="btn btn-danger btn-block">No items to display</a>
			{% endif %}
			{% if cartitem == 0 %}
			<a href="{% url 'index' %}" class="btn btn-light btn-block"></a>
			{% endif %}
		</div> <!-- card-body.// -->
		</div> <!-- card.// -->

</aside> <!-- col.// -->


</div> <!-- row.// -->
<!-- ============================ COMPONENT 1 END .// ================================= -->

</div> <!-- container .//  -->
</section>

<footer class="text-center text-white">
	<!-- Grid container -->
	<div  style="background-color: #f8f9fa;">
	  <!-- Section: Social media -->
	  <section >
	  
  
		<!-- Instagram -->
		<a
		  class="btn btn-link btn-floating btn-lg text-dark m-1"
		  href="#!"
		  role="button"
		  data-mdb-ripple-color="dark"
		  ><i class="fab fa-instagram"></i
		></a>
  
		<!-- Linkedin -->
		<a
		  class="btn btn-link btn-floating btn-lg text-dark m-1"
		  href="#!"
		  role="button"
		  data-mdb-ripple-color="dark"
		  ><i class="fab fa-linkedin"></i
		></a>
		<!-- Github -->
		<a
		  class="btn btn-link btn-floating btn-lg text-dark m-1"
		  href="#!"
		  role="button"
		  data-mdb-ripple-color="dark"
		  ><i class="fab fa-github"></i
		></a>
	   
	  </section>
	  <!-- Section: Social media -->
	</div>
	<!-- Grid container -->
  
   <!-- Copyright -->
  <div class="text-center text-dark p-3" style="background-color: rgba(0, 0, 0, 0.2); display: flex; align-items: center; justify-content: center; width: 100%;">
	<div>
	  © 2023 
	  <a class="text-dark" href="https://mdbootstrap.com/">Icart |  All Rights Reserved</a>
	</div>
	<div>
	  <a class="btn float-right" href="#!" role="button" data-mdb-ripple-color="dark"><p>Contact us</p></a>
	</div>
  </div>
  
	<!-- Copyright -->
  
  
  </footer>
<!-- ========================= SECTION CONTENT END// ========================= -->
<!-- <script src="{% static '/js/jquery-3.7.1.min.js' %}"></script> -->
<!-- jQuery for cart buttons -->
<script src="{% static '/js/custom.js' %}"></script>
<script src="//cdn.jsdelivr.net/npm/alertifyjs@1.13.1/build/alertify.min.js"></script>

<script>
    
    
    ('{% for msg in messages %}')
    alertify.set('notifier', 'position', 'bottom-right');
    alertify.success('<span style="color: green;">{{ msg }}</span>');
    ('{% endfor %}')
</script>
<!-- Bootstrap JS with Popper.js and jQuery -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js"></script>
<!-- jQuery for search product -->
<script src="https://code.jquery.com/ui/1.13.2/jquery-ui.js"></script>

<script>
var availableTags = [];

$.ajax({
  method: "GET",
  url: "/product-list",
  success: function (response) {
    startAutocomplete(response);
  }
});

function startAutocomplete(availableTags)
{
  $( "#searchproduct" ).autocomplete({
    source: availableTags
  });

}
</script> 


</body>
</html>